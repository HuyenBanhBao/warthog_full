<?xml version="1.0"?>
<launch>

  <!-- ❗ TẮT EKF KHI DÙNG GAZEBO + AMCL -->
  <arg name="enable_ekf" default="false"/>

  <arg name="config_extras"
       default="$(eval optenv('WARTHOG_CONFIG_EXTRAS', find('warthog_control') + '/config/empty.yaml'))"/>

  <rosparam command="load" file="$(find warthog_control)/config/control.yaml" />

  <node name="controller_spawner"
        pkg="controller_manager"
        type="spawner"
        args="warthog_joint_publisher warthog_velocity_controller --timeout 10" />

  <!-- ❌ EKF SẼ KHÔNG CHẠY VÌ enable_ekf=false -->
  <group if="$(arg enable_ekf)">
    <node pkg="robot_localization"
          type="ekf_localization_node"
          name="ekf_localization" />
  </group>

  <!-- Override default control parameters -->
  <rosparam command="load" file="$(arg config_extras)" />

</launch>

